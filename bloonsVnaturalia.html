<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bloons contre naturalia</title>
    <link rel="stylesheet" href="styling/style.css" />
  </head>
  <body>
    <div id="mainContainer">
      <img id="bloonsMap" src="images/MonkeyMeadow_No_UI.webp" alt="" />
    </div>

    <script>
      class Bloon {
        constructor(mainContainer) {
          this.animationStage = 0;
          this.mainContainer = mainContainer;
          this.bloons = []; // Array to store references to bloon instances
          this.createBloon();
          this.animation = setInterval(() => this.moveBloon(), 20);
        }

        createBloon() {
          const bloonContainer = document.createElement("div");
          bloonContainer.className = "bloonContainer";
          bloonContainer.innerHTML = '<div class="bloonBody"></div>';
          this.mainContainer.appendChild(bloonContainer);
          const bloon = {
            link: bloonContainer,
            left: 0,
            top: 36,
            lives: 5,
          };
          bloon.link.style.backgroundColor = "red";
          this.bloons.push(bloon); // Add bloon to the array
        }

        moveBloon() {
          this.bloons.forEach((bloon) => {
            if (this.animationStage < 147) {
              bloon.left += 0.5;
              this.animationStage += 1;
            } else if (this.animationStage < 192) {
              bloon.top -= 0.5;
              this.animationStage += 1;
            } else if (this.animationStage < 243) {
              bloon.left -= 0.5;
              this.animationStage += 1;
            } else if (this.animationStage < 365) {
              bloon.top += 0.5;
              this.animationStage += 1;
            } else if (this.animationStage < 417) {
              bloon.left -= 0.5;
              this.animationStage += 1;
            } else if (this.animationStage < 464) {
              bloon.top -= 0.5;
              this.animationStage += 1;
            } else if (this.animationStage < 608) {
              bloon.left += 0.5;
              this.animationStage += 1;
            } else if (this.animationStage < 658) {
              bloon.top -= 0.5;
              this.animationStage += 1;
            } else if (this.animationStage < 697) {
              bloon.left += 0.5;
              this.animationStage += 1;
            } else if (this.animationStage < 780) {
              bloon.top += 0.5;
              this.animationStage += 1;
            } else if (this.animationStage < 874) {
              bloon.left -= 0.5;
              this.animationStage += 1;
            } else if (this.animationStage < 950) {
              bloon.top += 0.5;
              this.animationStage += 1;
            }

            this.updateLocation(bloon.link, bloon.left, bloon.top);
          });

          if (this.animationStage >= 950) {
            clearInterval(this.animation); // Stop the animation when it reaches the desired position
          }
        }

        updateLocation(link, left, top) {
          link.style.left = left + "vh";
          link.style.top = top + "vh";
        }

        // Method to access information of all bloons
        getAllBloonsInfo() {
          return this.bloons.map((bloon) => ({
            link: bloon.link,
            left: bloon.left,
            top: bloon.top,
            lives: bloon.lives,
          }));
        }
      }

      // Example Usage
      const mainContainer = document.getElementById("mainContainer");
      const bloonInstance1 = new Bloon(mainContainer);
      const bloonInstance2 = new Bloon(mainContainer);

      // Access information of all bloons
      const allBloonsInfo = bloonInstance1.getAllBloonsInfo();
      console.log(allBloonsInfo);
    </script>
  </body>
</html>
